<!DOCTYPE html>
<html lang="en">
<!-- Skip Navigation -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- GDPR Cookie Consent (MUST load BEFORE gtag) -->
    <link rel="stylesheet" href="assets/css/cookie-consent.css?v=20260211">
    <link rel="stylesheet" href="assets/css/toast.css?v=20260214">
    <link rel="stylesheet" href="assets/css/form-validation.css?v=20260218">
    <script src="assets/js/toast.js?v=20260214" defer></script>
    <script src="assets/js/error-handler.js?v=20260218" defer></script>
    <script src="assets/js/cookie-consent.js?v=20260211" defer></script>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-80P17E7RZK"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-80P17E7RZK');
    </script>
    
    <!-- SEO Meta Tags -->
    <title>BILLIONAIRS - Exclusive Member Login | World's Most Private Luxury Club</title>
    <meta name="description" content="Login to BILLIONAIRS — the world's most exclusive private membership for billionaires and UHNWI. Swiss-secured, AES-256 encrypted, 2FA protected. Access your private luxury network in Zürich, Monaco & Dubai.">
    <meta name="keywords" content="billionairs login, billionaires login, luxury club login, exclusive membership access, private club portal, BILLIONAIRS member, luxury member login, elite club access, billionaire network login, Swiss private club login, UHNWI portal, ultra luxury access, VIP member login, exclusive wealth network">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://billionairs.luxury/login.html">
    <meta name="author" content="BILLIONAIRS LUXURY">
    <meta name="theme-color" content="#E8B4A0">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://billionairs.luxury/login.html">
    <meta property="og:title" content="BILLIONAIRS - Exclusive Member Login | World's Most Private Luxury Club">
    <meta property="og:description" content="Login to BILLIONAIRS — the world's most exclusive private membership for billionaires. Swiss-secured, encrypted, invitation only.">
    <meta property="og:image" content="https://billionairs.luxury/assets/images/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="BILLIONAIRS LUXURY">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="BILLIONAIRS - Exclusive Member Login | World's Most Private Luxury Club">
    <meta name="twitter:description" content="Login to BILLIONAIRS — the world's most exclusive private membership for billionaires. Swiss-secured, encrypted, invitation only.">
    <meta name="twitter:image" content="https://billionairs.luxury/assets/images/og-image.jpg">

    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;900&family=Montserrat:wght@300;400;500;600;700&display=swap" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;900&family=Montserrat:wght@300;400;500;600;700&display=swap"></noscript>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print">
    
    <!-- Particles.js -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js" defer></script>
    
    <!-- i18n Language System -->
    <script src="assets/js/i18n.js?v=20260218" defer></script>
    <script src="assets/js/lang-dropdown-simple.js?v=20260218" defer></script>
    <script src="assets/js/login-i18n.js?v=20260218" defer></script>
    
    <style>
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }

        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            background: radial-gradient(ellipse at center, 
                            rgba(232, 180, 160, 0.03) 0%, 
                            transparent 50%,
                            rgba(0, 0, 0, 0.3) 100%),
                        linear-gradient(135deg, 
                            rgba(245, 212, 193, 0.02) 0%, 
                            transparent 40%, 
                            rgba(201, 165, 103, 0.02) 100%);
            position: relative;
            overflow: hidden;
            z-index: 5;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, 
                rgba(232, 180, 160, 0.05) 0%, 
                transparent 50%
            );
            animation: slowRotate 60s linear infinite;
            pointer-events: none;
        }

        @keyframes slowRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .login-box {
            background: linear-gradient(135deg, rgba(232, 180, 160, 0.08) 0%, rgba(26, 26, 26, 0.9) 100%);
            border: 2px solid rgba(232, 180, 160, 0.2);
            border-radius: 20px;
            padding: 3rem;
            max-width: 500px;
            width: 100%;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .login-logo {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-logo img {
            width: 80px;
            height: 80px;
            margin-bottom: 1rem;
        }

        .login-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 900;
            color: #E8B4A0;
            text-align: center;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .login-subtitle {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            color: rgba(255,255,255,0.5);
            text-align: center;
            margin-bottom: 2.5rem;
            font-weight: 300;
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .tab {
            flex: 1;
            padding: 1rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: rgba(255,255,255,0.5);
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #E8B4A0;
            border-bottom-color: #E8B4A0;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3) !important;
            border: 1px solid rgba(232, 180, 160, 0.2);
            border-radius: 8px;
            color: white !important;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            -webkit-text-fill-color: white !important;
        }

        .form-input:focus {
            outline: none;
            border-color: #E8B4A0;
            background: rgba(0, 0, 0, 0.5) !important;
        }

        /* Override browser autofill styles - Match other fields exactly */
        .form-input:-webkit-autofill,
        .form-input:-webkit-autofill:hover,
        .form-input:-webkit-autofill:focus,
        .form-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.3) inset !important;
            -webkit-text-fill-color: white !important;
            border: 1px solid rgba(232, 180, 160, 0.2) !important;
            caret-color: white !important;
            background-color: rgba(0, 0, 0, 0.3) !important;
            background-image: none !important;
            transition: background-color 5000s ease-in-out 0s;
        }
        
        input:-webkit-autofill::first-line {
            color: white !important;
            font-family: 'Montserrat', sans-serif !important;
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.3) !important;
        }

        .submit-button {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, #E8B4A0 0%, #D4A574 100%);
            color: rgba(0,0,0,0.9);
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(232, 180, 160, 0.4);
            background: linear-gradient(135deg, #F5D4C1 0%, #E8B4A0 100%);
        }

        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .error-message {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.5);
            color: #f44336;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            display: none;
        }

        .success-message {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid rgba(76, 175, 80, 0.5);
            color: #4CAF50;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            display: none;
        }

        .back-link {
            text-align: center;
            margin-top: 2rem;
        }

        .back-link a {
            color: rgba(255,255,255,0.5);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .back-link a:hover {
            color: #E8B4A0;
        }

        .password-requirements {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.4);
            margin-top: 0.5rem;
        }

        /* Forgot Password Link Styles */
        #forgotPasswordLink:hover {
            color: #E8B4A0 !important;
        }

        #backToLoginLink:hover {
            color: #E8B4A0 !important;
        }

        /* Smooth transitions for modal */
        #forgotPasswordModal, #loginForm {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Login Loading Overlay */
        .login-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 10, 0.85);
            border-radius: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.2rem;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 10;
            animation: overlayFadeIn 0.3s ease;
        }

        @keyframes overlayFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .login-spinner {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(232, 180, 160, 0.15);
            border-top: 2px solid #E8B4A0;
            border-radius: 50%;
            animation: spinLogin 1s linear infinite;
        }

        @keyframes spinLogin {
            to { transform: rotate(360deg); }
        }

        .login-overlay-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.7rem;
            letter-spacing: 3px;
            color: rgba(232, 180, 160, 0.7);
            text-transform: uppercase;
        }

        .login-overlay-sub {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.55rem;
            letter-spacing: 1.5px;
            color: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-nav" data-i18n="common.skip_to_main">Skip to main content</a>
    <!-- Particles Background -->
    <div id="particles-js"></div>
    
    <!-- Language Dropdown (positioned absolutely) -->
    <div id="langDropdownContainer" style="position: fixed; top: 20px; right: 20px; z-index: 10000;">
        <button class="lang-switcher" id="langBtn" aria-label="Switch language" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.7);padding:0.5rem 1rem;font-size:0.75rem;font-weight:600;letter-spacing:1.5px;border-radius:20px;cursor:pointer;transition:all 0.3s ease;">EN</button>
    </div>
    
    <main id="main-content" role="main" tabindex="-1">
    <div class="login-container">
        <div class="login-box">
            <div class="login-logo" onclick="window.location.href='/'" style="cursor: pointer;">
                <img src="assets/images/logo.png" alt="BILLIONAIRS">
            </div>
            
            <h1 class="login-title" data-i18n="login.title">Access Portal</h1>
            <p class="login-subtitle" data-i18n="login.subtitle">Enter the exclusive realm</p>

            <!-- Login only (registration handled via payment flow) -->

            <div id="errorMessage" class="error-message" role="alert" aria-live="assertive"></div>
            <div id="successMessage" class="success-message" role="status" aria-live="polite"></div>

            <!-- Login Form -->
            <form id="loginForm" style="display: block;">
                <div class="form-group">
                    <label class="form-label" for="loginEmail" data-i18n="login.email">Email Address</label>
                    <input type="email" id="loginEmail" class="form-input" required
                           style="background: rgba(0, 0, 0, 0.3) !important; color: white !important; -webkit-text-fill-color: white !important;">
                </div>
                <div class="form-group">
                    <label class="form-label" for="loginPassword" data-i18n="login.password">Password</label>
                    <input type="password" id="loginPassword" class="form-input" required
                           style="background: rgba(0, 0, 0, 0.3) !important; color: white !important; -webkit-text-fill-color: white !important;">
                </div>
                
                <div style="text-align: right; margin-bottom: 1.5rem;">
                    <a href="#" id="forgotPasswordLink" data-i18n="login.forgot_password" style="color: rgba(232, 180, 160, 0.8); font-size: 13px; text-decoration: none; letter-spacing: 1px; transition: all 0.3s ease;">
                        Forgot Password?
                    </a>
                </div>
                
                <button type="submit" class="submit-button" data-i18n="login.submit">Enter</button>
            </form>

            <!-- Two-Factor Authentication Step -->
            <div id="twoFactorModal" style="display: none;">
                <div class="twofa-login-section">
                    <div class="twofa-login-icon">
                        <svg viewBox="0 0 48 48" width="48" height="48" fill="none">
                            <rect x="10" y="6" width="28" height="36" rx="4" stroke="#E8B4A0" stroke-width="2" fill="rgba(232,180,160,0.05)"/>
                            <circle cx="24" cy="38" r="2" fill="rgba(232,180,160,0.4)"/>
                            <rect x="16" y="18" width="16" height="10" rx="2" stroke="rgba(232,180,160,0.4)" stroke-width="1.5" fill="none"/>
                            <text x="24" y="26" text-anchor="middle" fill="#E8B4A0" font-size="7" font-family="Montserrat" font-weight="600">2FA</text>
                        </svg>
                    </div>
                    <h2 class="twofa-login-title" data-i18n="login.twofa_title">Authentication Code</h2>
                    <p class="twofa-login-hint" data-i18n="login.twofa_hint">Enter the 6-digit code from your<br>Microsoft Authenticator app</p>
                    
                    <div class="twofa-code-inputs" id="twofaCodeInputs" role="group" aria-label="6-digit verification code">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="0" autocomplete="one-time-code" aria-label="Digit 1 of 6">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="1" aria-label="Digit 2 of 6">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="2" aria-label="Digit 3 of 6">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="3" aria-label="Digit 4 of 6">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="4" aria-label="Digit 5 of 6">
                        <input type="text" inputmode="numeric" maxlength="1" class="twofa-code-digit" data-index="5" aria-label="Digit 6 of 6">
                    </div>

                    <div id="twofaError" class="error-message" style="display: none; margin-bottom: 1rem;" role="alert"></div>

                    <button type="button" class="submit-button" id="verifyTwofaBtn" onclick="verifyTwoFactorCode()" data-i18n="login.twofa_verify">VERIFY</button>

                    <div class="twofa-backup-link">
                        <a href="#" id="useBackupCodeLink" data-i18n="login.twofa_use_backup">Use a backup code instead</a>
                    </div>

                    <!-- Backup Code Input (hidden by default) -->
                    <div id="backupCodeSection" style="display: none; margin-top: 1rem;">
                        <div class="form-group">
                            <label class="form-label" data-i18n="login.twofa_backup_label">Backup Code</label>
                            <input type="text" id="backupCodeInput" class="form-input" placeholder="XXXX-XXXX"
                                   style="background: rgba(0, 0, 0, 0.3) !important; color: white !important; text-align: center; letter-spacing: 0.15em; font-family: 'Courier New', monospace;">
                        </div>
                        <button type="button" class="submit-button" onclick="verifyBackupCode()" data-i18n="login.twofa_verify_backup">VERIFY BACKUP CODE</button>
                    </div>

                    <div style="text-align: center; margin-top: 1.2rem;">
                        <a href="#" id="backToLoginFromTwofa" style="color: rgba(232, 180, 160, 0.6); font-size: 12px; text-decoration: none;" data-i18n="login.back_to_login">
                            ← Back to Login
                        </a>
                    </div>
                </div>
            </div>

            <!-- Forgot Password Modal -->
            <div id="forgotPasswordModal" style="display: none;">
                <h2 class="login-subtitle" style="margin-bottom: 1rem;" data-i18n="login.reset_password_title">Reset Password</h2>
                <p style="color: rgba(255, 255, 255, 0.7); font-size: 13px; margin-bottom: 1.5rem; line-height: 1.6;" data-i18n="login.reset_password_description">
                    Enter your email address and we'll send you a link to reset your password.
                </p>
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label class="form-label" for="forgotEmail" data-i18n="login.email_label">Email Address</label>
                        <input type="email" id="forgotEmail" class="form-input" required
                               style="background: rgba(0, 0, 0, 0.3) !important; color: white !important; -webkit-text-fill-color: white !important;">
                    </div>
                    <button type="submit" class="submit-button" id="sendResetBtn" data-i18n="login.send_reset_link">Send Reset Link</button>
                    <div style="text-align: center; margin-top: 1rem;">
                        <a href="#" id="backToLoginLink" data-i18n="login.back_to_login" style="color: rgba(232, 180, 160, 0.8); font-size: 13px; text-decoration: none;">
                            ← Back to Login
                        </a>
                    </div>
                </form>
            </div>

            <!-- Registration is only available after purchase - kept out of the public login portal -->

            <div class="back-link">
                <a href="/" data-i18n="login.back_home">← Back to Home</a>
            </div>
        </div>
    </div>
    </main>

    <script src="assets/js/auth.js"></script>
    <script>
        // Login-only page: registration is performed through the purchase flow (I DESERVE THIS)

        // Store credentials for 2FA re-submission
        let pendingEmail = '';
        let pendingPassword = '';

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => errorDiv.style.display = 'none', 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => successDiv.style.display = 'none', 3000);
        }

        function hideMessages() {
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }

        // ===== TWO-FACTOR AUTHENTICATION UI =====
        function showTwoFactorStep() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('twoFactorModal').style.display = 'block';
            // Focus first digit
            const firstInput = document.querySelector('.twofa-code-digit[data-index="0"]');
            if (firstInput) setTimeout(() => firstInput.focus(), 100);
        }

        function hideTwoFactorStep() {
            document.getElementById('twoFactorModal').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('twofaError').style.display = 'none';
            document.getElementById('backupCodeSection').style.display = 'none';
            // Clear code inputs
            document.querySelectorAll('.twofa-code-digit').forEach(el => { el.value = ''; el.classList.remove('filled'); });
            pendingEmail = '';
            pendingPassword = '';
        }

        // Auto-advance code digit inputs
        document.addEventListener('DOMContentLoaded', () => {
            const digits = document.querySelectorAll('.twofa-code-digit');
            digits.forEach((input, idx) => {
                input.addEventListener('input', (e) => {
                    const val = e.target.value.replace(/\D/g, '');
                    e.target.value = val;
                    if (val.length === 1) {
                        e.target.classList.add('filled');
                        if (idx < 5) digits[idx + 1].focus();
                        // Auto-submit when all 6 entered
                        if (idx === 5) {
                            const code = Array.from(digits).map(d => d.value).join('');
                            if (code.length === 6) setTimeout(() => verifyTwoFactorCode(), 200);
                        }
                    } else {
                        e.target.classList.remove('filled');
                    }
                });
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && !e.target.value && idx > 0) {
                        digits[idx - 1].focus();
                        digits[idx - 1].value = '';
                        digits[idx - 1].classList.remove('filled');
                    }
                });
                // Handle paste (e.g. from authenticator app)
                input.addEventListener('paste', (e) => {
                    e.preventDefault();
                    const paste = (e.clipboardData || window.clipboardData).getData('text').replace(/\D/g, '');
                    if (paste.length >= 6) {
                        for (let i = 0; i < 6; i++) {
                            digits[i].value = paste[i];
                            digits[i].classList.add('filled');
                        }
                        setTimeout(() => verifyTwoFactorCode(), 300);
                    }
                });
            });

            // Backup code link
            document.getElementById('useBackupCodeLink')?.addEventListener('click', (e) => {
                e.preventDefault();
                const section = document.getElementById('backupCodeSection');
                const codeInputs = document.getElementById('twofaCodeInputs');
                const verifyBtn = document.getElementById('verifyTwofaBtn');
                if (section.style.display === 'none') {
                    section.style.display = 'block';
                    codeInputs.style.display = 'none';
                    verifyBtn.style.display = 'none';
                    e.target.textContent = 'Use authenticator code instead';
                    document.getElementById('backupCodeInput').focus();
                } else {
                    section.style.display = 'none';
                    codeInputs.style.display = 'flex';
                    verifyBtn.style.display = 'block';
                    e.target.textContent = 'Use a backup code instead';
                    document.querySelector('.twofa-code-digit[data-index="0"]').focus();
                }
            });

            // Back to login from 2FA
            document.getElementById('backToLoginFromTwofa')?.addEventListener('click', (e) => {
                e.preventDefault();
                hideTwoFactorStep();
            });
        });

        async function verifyTwoFactorCode() {
            const digits = document.querySelectorAll('.twofa-code-digit');
            const code = Array.from(digits).map(d => d.value).join('');
            if (code.length !== 6) {
                document.getElementById('twofaError').textContent = 'Please enter all 6 digits';
                document.getElementById('twofaError').style.display = 'block';
                return;
            }
            await submitWithTwoFactor(code);
        }

        async function verifyBackupCode() {
            const code = document.getElementById('backupCodeInput').value.trim();
            if (!code) {
                document.getElementById('twofaError').textContent = 'Please enter your backup code';
                document.getElementById('twofaError').style.display = 'block';
                return;
            }
            await submitWithTwoFactor(code);
        }

        async function submitWithTwoFactor(code) {
            const btn = document.getElementById('verifyTwofaBtn');
            const twofaError = document.getElementById('twofaError');
            twofaError.style.display = 'none';

            const currentLang = window.i18nManager?.currentLang || localStorage.getItem('billionairs_lang') || 'en';

            try {
                if (btn) { btn.disabled = true; btn.textContent = 'VERIFYING...'; }

                const result = await window.authManager.login(pendingEmail, pendingPassword, code);

                if (result.requiresTwoFactor && !result.success) {
                    // Invalid code
                    twofaError.textContent = result.message || 'Invalid verification code';
                    twofaError.style.display = 'block';
                    document.querySelectorAll('.twofa-code-digit').forEach(d => { d.value = ''; d.classList.remove('filled'); });
                    document.querySelector('.twofa-code-digit[data-index="0"]')?.focus();
                    if (btn) { btn.disabled = false; btn.textContent = 'VERIFY'; }
                    return;
                }

                if (result.success) {
                    localStorage.setItem('userEmail', pendingEmail);
                    if (btn) { btn.textContent = '✓ VERIFIED'; btn.style.background = 'linear-gradient(135deg, #4CAF50 0%, #388E3C 100%)'; }
                    setTimeout(() => window.location.href = '/dashboard.html?lang=' + currentLang, 800);
                }
            } catch (error) {
                twofaError.textContent = error.message || 'Verification failed';
                twofaError.style.display = 'block';
                if (btn) { btn.disabled = false; btn.textContent = 'VERIFY'; }
            }
        }
        // ===== END TWO-FACTOR UI =====

        // Handle Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            hideMessages();

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const submitBtn = e.target.querySelector('.submit-button');

            // i18n helper for overlay
            const currentLang = window.i18nManager?.currentLang || localStorage.getItem('billionairs_lang') || localStorage.getItem('selectedLanguage') || 'en';
            const overlayT = (key, fallback) => {
                try { return window.i18nManager?.translations?.login?.[key] || fallback; }
                catch { return fallback; }
            };

            // Show elegant overlay
            const loginBox = document.querySelector('.login-box');
            const overlay = document.createElement('div');
            overlay.className = 'login-overlay';
            overlay.setAttribute('role', 'status');
            overlay.setAttribute('aria-live', 'polite');
            overlay.innerHTML = `
                <div class="login-spinner"></div>
                <span class="login-overlay-text">${overlayT('overlay_verifying', 'Verifying Access')}</span>
                <span class="login-overlay-sub">${overlayT('overlay_authenticating', 'Authenticating your credentials...')}</span>
            `;

            try {
                submitBtn.disabled = true;
                loginBox.appendChild(overlay);

                const result = await window.authManager.login(email, password);
                
                // Check if 2FA is required
                if (result.requiresTwoFactor) {
                    if (overlay.parentNode) overlay.remove();
                    submitBtn.disabled = false;
                    pendingEmail = email;
                    pendingPassword = password;
                    showTwoFactorStep();
                    return;
                }

                // Store email for Easter Egg system
                localStorage.setItem('userEmail', email);
                
                // Update overlay to success
                overlay.querySelector('.login-overlay-text').textContent = overlayT('overlay_granted', 'Access Granted');
                overlay.querySelector('.login-overlay-sub').textContent = overlayT('overlay_redirecting', 'Redirecting to your dashboard...');
                overlay.querySelector('.login-spinner').style.borderTopColor = '#4CAF50';
                
                setTimeout(() => window.location.href = '/dashboard.html?lang=' + currentLang, 1200);
            } catch (error) {
                if (overlay.parentNode) overlay.remove();
                showError(error.message);
                submitBtn.disabled = false;
            }
        });

        // Registration removed from this portal. Accounts are created via the purchase confirmation flow.

        // Check if already logged in
        window.onload = async () => {
            // Check for language parameter in URL
            const urlParams = new URLSearchParams(window.location.search);
            const langParam = urlParams.get('lang');
            
            // If language parameter exists, set it before initializing i18n
            if (langParam && ['en', 'de', 'fr', 'es', 'zh', 'ar', 'it', 'ru', 'ja'].includes(langParam)) {
                localStorage.setItem('billionairs_lang', langParam);
            }
            
            // Initialize i18n
            if (typeof I18nManager !== 'undefined') {
                window.i18nManager = new I18nManager();
                await window.i18nManager.init();
            }

            const isValid = await window.authManager.verifySession();
            if (isValid) {
                // Get current language
                const currentLang = window.i18nManager?.currentLang || localStorage.getItem('selectedLanguage') || 'en';
                window.location.href = '/dashboard.html?lang=' + currentLang;
            }
        };

        // Forgot Password Modal Toggle
        document.getElementById('forgotPasswordLink').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('forgotPasswordModal').style.display = 'block';
            hideMessages();
        });

        document.getElementById('backToLoginLink').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('forgotPasswordModal').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            hideMessages();
        });

        // Handle Forgot Password Submit
        document.getElementById('forgotPasswordForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            hideMessages();

            const email = document.getElementById('forgotEmail').value;
            const submitBtn = document.getElementById('sendResetBtn');

            // Get i18n instance for translations
            const i18n = window.i18nManager;
            const originalText = submitBtn.textContent;

            // Loading State
            submitBtn.disabled = true;
            submitBtn.textContent = i18n ? i18n.t('login.sending') : 'Sending...';

            try {
                const response = await fetch('/api/forgot-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();

                if (data.success) {
                    showSuccess(data.message);
                    document.getElementById('forgotEmail').value = '';
                } else {
                    const genericErr = (window.i18nManager && window.i18nManager.t('errors.generic_error')) || 'An error occurred.';
                    showError(data.error || genericErr);
                }
            } catch (error) {
                console.error('Forgot password error:', error);
                const connMsg = (window.i18nManager && window.i18nManager.t('errors.connection_error')) || 'Connection error. Please try again.';
                showError(connMsg);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        });
    </script>

    <!-- Initialize Particles.js -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        if (typeof particlesJS === 'undefined') return;
        particlesJS('particles-js', {
            particles: {
                number: { value: 120, density: { enable: true, value_area: 800 } },
                color: { value: '#E8B4A0' },
                shape: { type: 'circle' },
                opacity: {
                    value: 0.6,
                    random: true,
                    anim: {
                        enable: true,
                        speed: 1,
                        opacity_min: 0.3,
                        sync: false
                    }
                },
                size: {
                    value: 4,
                    random: true,
                    anim: {
                        enable: true,
                        speed: 2,
                        size_min: 0.5,
                        sync: false
                    }
                },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: '#D4A574',
                    opacity: 0.4,
                    width: 1.5
                },
                move: {
                    enable: true,
                    speed: 2,
                    direction: 'none',
                    random: true,
                    straight: false,
                    out_mode: 'out',
                    bounce: false,
                    attract: {
                        enable: false,
                        rotateX: 600,
                        rotateY: 1200
                    }
                }
            },
            interactivity: {
                detect_on: 'window',
                events: {
                    onhover: { enable: true, mode: 'repulse' },
                    onclick: { enable: true, mode: 'push' },
                    resize: true
                },
                modes: {
                    repulse: { distance: 100, duration: 0.4 },
                    push: { particles_nb: 4 }
                }
            },
            retina_detect: true
        });
        });
    </script>
    <!-- Visitor Tracking -->
    <script>
    (function(){try{var s=sessionStorage,k='_bv_sid',i=s.getItem(k);if(!i){i=Math.random().toString(36).slice(2,10)+Date.now().toString(36);s.setItem(k,i)}var p='_bv_'+location.pathname;if(s.getItem(p))return;s.setItem(p,'1');var e=null;try{e=localStorage.getItem('userEmail')}catch(x){}fetch('/api/track-visit',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({page:location.pathname,referrer:document.referrer||'',sessionId:i,email:e})}).catch(function(){})}catch(x){}})()
    </script>
    <script src="/assets/js/accessibility.js" defer></script>
    <script src="assets/js/form-validation.js?v=20260218" defer></script>
</body>
