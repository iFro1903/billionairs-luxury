class LuxuryTimepiece{constructor(){this.currentLocation=null,this.currentTimezone=null,this.clockStyle="elegant",this.isPaymentComplete=!1,this.clockInterval=null,this.worldClockIntervals=[],this.currentSection="hero",this.pyramids=[],this.mouseX=0,this.mouseY=0,this.slotCountdownInterval=null,window.addEventListener("beforeunload",()=>this.cleanup()),this.init()}cleanup(){this.clockInterval&&(clearInterval(this.clockInterval),this.clockInterval=null),this.slotCountdownInterval&&(clearInterval(this.slotCountdownInterval),this.slotCountdownInterval=null),this.worldClockIntervals.forEach(e=>clearInterval(e)),this.worldClockIntervals=[]}async init(){this.initEventListeners(),this.initPyramids(),this.initSlotCountdown(),this.checkPaymentStatus(),this.checkHashNavigation()}checkHashNavigation(){if("#paymentSection"===window.location.hash){const e=document.getElementById("heroSection"),t=document.getElementById("transitionSection"),n=document.getElementById("rejectionSection");e&&(e.style.display="none"),t&&(t.style.display="none",t.classList.remove("active")),n&&(n.style.display="none",n.classList.remove("active")),setTimeout(()=>{this.showPaymentSection()},100)}}async showTransition(e,t=2500){const n=document.getElementById("transitionSection");return new Promise(o=>{if(!n)return e&&e(),void o();n.style.display="flex",n.style.opacity="1",setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.style.display="none",n.style.opacity="1",e&&e(),o()},600)},t)})}initEventListeners(){const e=document.querySelector(".nav-logo"),t=document.querySelector(".nav-logo-img");e&&(e.style.cursor="pointer",e.addEventListener("click",()=>{window.location.href="/"})),t&&(t.style.cursor="pointer");const n=document.getElementById("proceedBtn"),o=document.getElementById("notReadyBtn");n&&n.addEventListener("click",()=>this.handleProceed()),o&&o.addEventListener("click",()=>this.handleNotReady());const i=document.getElementById("proceedToPaymentBtn");i&&i.addEventListener("click",()=>this.handleProceedToPayment());const s=document.getElementById("paymentForm");s&&s.addEventListener("submit",e=>this.handlePayment(e)),this.initInputFormatting(),window.addEventListener("resize",()=>this.adjustClockSize()),document.addEventListener("mousemove",e=>this.handleMouseMove(e))}initPyramids(){this.pyramids=Array.from(document.querySelectorAll(".pyramid-element")).map(e=>{e.getBoundingClientRect();return{element:e,initialX:parseFloat(e.style.left||getComputedStyle(e).left),initialY:parseFloat(e.style.top||getComputedStyle(e).top),currentX:0,currentY:0}})}initMagneticButtons(){document.querySelectorAll(".cta-button, .proceed-button, .return-button, .leave-button").forEach(e=>{e.classList.add("btn-magnetic"),e.addEventListener("mousemove",t=>{const n=e.getBoundingClientRect(),o=.2*(t.clientX-n.left-n.width/2),i=.2*(t.clientY-n.top-n.height/2);e.style.transform=`translate(${o}px, ${i}px)`}),e.addEventListener("mouseleave",()=>{e.style.transform="translate(0, 0)"})})}initRippleEffect(){document.querySelectorAll(".cta-button, .proceed-button, .return-button, .leave-button, .payment-button, button").forEach(e=>{e.classList.add("ripple-container"),e.addEventListener("click",t=>{const n=document.createElement("span");n.classList.add("ripple"),e.classList.contains("cta-button")||e.classList.contains("proceed-button")?n.classList.add("ripple-gold"):e.classList.contains("return-button")&&n.classList.add("ripple-green");const o=e.getBoundingClientRect(),i=t.clientX-o.left,s=t.clientY-o.top;n.style.left=`${i}px`,n.style.top=`${s}px`,e.appendChild(n),setTimeout(()=>{n.remove()},600)})})}handleMouseMove(e){this.mouseX=e.clientX,this.mouseY=e.clientY,this.pyramids.forEach(e=>{const t=e.element.getBoundingClientRect(),n=t.left+t.width/2,o=t.top+t.height/2,i=n-this.mouseX,s=o-this.mouseY,a=Math.sqrt(i*i+s*s);if(a<200){const t=(200-a)/200,n=i/a*t*50,o=s/a*t*50;e.currentX=n,e.currentY=o}else e.currentX*=.95,e.currentY*=.95;e.element.style.transform=`translate(${e.currentX}px, ${e.currentY}px)`})}handleProceed(){const e=document.getElementById("heroSection"),t=document.getElementById("trustValueSection");e&&(e.classList.remove("active"),e.style.display="none"),window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0,t&&(t.style.display="flex",setTimeout(()=>{t.classList.add("active")},50))}handleProceedToPayment(){const e=document.getElementById("trustValueSection");e&&(e.classList.remove("active"),e.style.display="none"),window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0,this.showTransitionScreen(),setTimeout(()=>{this.hideTransitionScreen(),this.showPaymentSection()},1500)}handleNotReady(){const e=document.getElementById("heroSection");e&&e.classList.remove("active"),this.showRejectionScreen()}showRejectionScreen(){const e=document.querySelector(".hero-section"),t=document.getElementById("rejectionSection");if(window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0,e&&t){e.classList.remove("active"),e.style.display="none",t.style.display="flex",t.classList.add("active"),setTimeout(()=>{particlesJS("particles-rejection",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#FF6B6B"},shape:{type:"circle"},opacity:{value:.6,random:!0},size:{value:3,random:!0},line_linked:{enable:!0,distance:150,color:"#FF6B6B",opacity:.4,width:1},move:{enable:!0,speed:1.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1},onclick:{enable:!1},resize:!0}},retina_detect:!0})},100);const n=document.getElementById("returnBtn"),o=document.getElementById("leaveBtn");n&&n.addEventListener("click",()=>{t.style.display="none",this.showTransitionScreen(),setTimeout(()=>{this.hideTransitionScreen(),this.showPaymentSection()},1500)}),o&&o.addEventListener("click",()=>{window.toast.info("Access window closing. Return when ready.",{title:"Session Ending"}),window.location.reload()})}}showDismissiveMessage(){const e=document.createElement("div");e.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: rgba(0, 0, 0, 0.9);\n            border: 2px solid var(--rose-gold-primary);\n            border-radius: 20px;\n            padding: 3rem;\n            text-align: center;\n            z-index: 10000;\n            animation: fadeInScale 0.5s ease;\n            box-shadow: 0 0 50px var(--rose-gold-glow);\n        ",e.innerHTML='\n            <h2 style="color: var(--rose-gold-primary); font-family: \'Playfair Display\', serif; font-size: 2rem; margin-bottom: 1rem; letter-spacing: 2px;">UNDERSTOOD</h2>\n            <p style="color: #ffffff; font-size: 1.2rem; margin-bottom: 2rem; letter-spacing: 1px;">Return when you\'re ready</p>\n            <button onclick="this.parentElement.remove()" style="\n                background: transparent;\n                border: 2px solid var(--rose-gold-primary);\n                color: var(--rose-gold-primary);\n                padding: 1rem 2rem;\n                border-radius: 25px;\n                cursor: pointer;\n                font-weight: 600;\n                letter-spacing: 2px;\n                transition: all 0.3s ease;\n            " onmouseover="this.style.background=\'var(--rose-gold-primary)\'; this.style.color=\'#000\';" onmouseout="this.style.background=\'transparent\'; this.style.color=\'var(--rose-gold-primary)\';">CLOSE</button>\n        ',document.body.appendChild(e),setTimeout(()=>{e.parentElement&&e.remove()},5e3)}showTransitionScreen(){const e=document.getElementById("heroSection"),t=document.getElementById("transitionSection");e&&t&&(e.classList.remove("active"),e.style.transition="all 1s ease",e.style.opacity="0",e.style.transform="translateY(-50px)",setTimeout(()=>{e.classList.add("hidden"),t.style.display="flex",t.classList.add("active"),setTimeout(()=>{t.style.transition="all 1s ease"},100)},1e3))}hideTransitionScreen(){const e=document.getElementById("transitionSection");e&&(e.classList.remove("active"),e.style.transition="all 1s ease",setTimeout(()=>{e.style.display="none"},600))}showPaymentSection(){const e=document.getElementById("transitionSection"),t=document.getElementById("paymentSection"),n=document.getElementById("memberBtn");t&&(e&&"none"!==e.style.display&&(e.style.display="none",e.classList.remove("active")),n&&(n.style.display="none"),t.classList.remove("hidden"),t.classList.add("active"))}initInputFormatting(){const e=document.getElementById("cardNumber");e&&e.addEventListener("input",e=>{let t=e.target.value.replace(/\s+/g,"").replace(/[^0-9]/gi,""),n=t.match(/.{1,4}/g)?.join(" ")||t;e.target.value=n});const t=document.getElementById("expiryDate");t&&t.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"");t.length>=2&&(t=t.substring(0,2)+"/"+t.substring(2,4)),e.target.value=t});const n=document.getElementById("cvv");n&&n.addEventListener("input",e=>{e.target.value=e.target.value.replace(/\D/g,"")})}async handlePayment(e){e.preventDefault(),window.paymentMethodSelector?await window.paymentMethodSelector.initiatePayment():window.stripeProcessor?await window.stripeProcessor.createCheckoutSession():(console.error("No payment processor available"),this.showPaymentError("Payment system temporarily unavailable. Please try again."))}validatePaymentData(e){const t=e.cardNumber.replace(/\s/g,"");return!(t.length<13||t.length>19)&&(!!e.expiryDate.match(/^\d{2}\/\d{2}$/)&&(!(e.cvv.length<3||e.cvv.length>4)&&!(e.cardHolder.length<2)))}showPaymentProcessing(){const e=document.querySelector(".payment-button");e.innerHTML;e.disabled=!0,e.innerHTML='\n            <div style="display: flex; align-items: center; justify-content: center;">\n                <div style="width: 20px; height: 20px; border: 2px solid rgba(0,0,0,0.3); border-top: 2px solid #000; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px;"></div>\n                <span>PROCESSING...</span>\n            </div>\n        '}showPaymentError(e){const t=document.createElement("div");t.className="payment-error",t.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: linear-gradient(45deg, #ff4444, #cc3333);\n            color: white;\n            padding: 1rem 2rem;\n            border-radius: 10px;\n            box-shadow: 0 10px 30px rgba(255, 68, 68, 0.3);\n            z-index: 10000;\n            animation: slideInRight 0.3s ease;\n        ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.remove()},4e3)}completePayment(){this.isPaymentComplete=!0,localStorage.setItem("luxuryTimepieceAccess","granted"),this.showTimepiece()}initSlotCountdown(){const e=document.getElementById("memberSlots");if(!e)return;this.slotCountdownInterval&&clearInterval(this.slotCountdownInterval);let t=Math.floor(7*Math.random())+3;e.textContent=`${t} SLOTS REMAINING`,this.slotCountdownInterval=setInterval(()=>{t>1?(t--,e.textContent=`${t} ${1===t?"SLOT":"SLOTS"} REMAINING`,t<=3&&(e.style.color="#FF6B6B",e.style.animation="urgentFlash 1s ease-in-out infinite")):(e.textContent="LAST SLOT",e.style.color="#FF4444")},45e3*Math.random()+45e3)}checkPaymentStatus(){"granted"===localStorage.getItem("luxuryTimepieceAccess")?(this.isPaymentComplete=!0,setTimeout(()=>{this.showTimepiece()},100)):setTimeout(()=>{this.showHeroSection()},100)}showHeroSection(){const e=document.getElementById("heroSection"),t=document.getElementById("paymentSection");e&&(t?.classList.add("hidden"),e.classList.remove("hidden"),this.currentSection="hero")}showTimepiece(){const e=document.getElementById("paymentSection"),t=document.getElementById("timepieceSection");e&&t&&(e.classList.add("hidden"),t.classList.remove("hidden"),this.initTimepiece(),t.style.opacity="0",t.style.transform="translateY(20px)",setTimeout(()=>{t.style.transition="opacity 0.8s ease-out, transform 0.8s ease-out",t.style.opacity="1",t.style.transform="translateY(0)"},100))}async initTimepiece(){await this.getUserLocation(),this.startClock(),this.updateLocationDisplay()}async getUserLocation(){return navigator.geolocation?new Promise(e=>{navigator.geolocation.getCurrentPosition(async t=>{try{const{latitude:n,longitude:o}=t.coords;this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone;const i=await this.reverseGeocode(n,o);this.currentLocation=i,e()}catch(t){this.currentLocation="Unknown location",this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone,e()}},t=>{this.currentLocation="Access denied",this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone,e()},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}):(this.currentLocation="Location unavailable",void(this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone))}async reverseGeocode(e,t){try{const e={"Europe/Zurich":"Zurich, Switzerland","Europe/Berlin":"Berlin, Germany","Europe/London":"London, United Kingdom","America/New_York":"New York, USA","America/Los_Angeles":"Los Angeles, USA","Asia/Tokyo":"Tokyo, Japan","Asia/Dubai":"Dubai, UAE","Europe/Paris":"Paris, France","Asia/Singapore":"Singapore","Australia/Sydney":"Sydney, Australia"},t=Intl.DateTimeFormat().resolvedOptions().timeZone;return e[t]||`${t.replace("_"," ")}`}catch(e){return"Secured Location"}}updateLocationDisplay(){const e=document.getElementById("currentLocation"),t=document.getElementById("currentTimezone");e&&this.currentLocation&&(e.textContent=this.currentLocation),t&&this.currentTimezone&&(t.textContent=this.currentTimezone.replace("_"," "))}startClock(){this.clockInterval&&clearInterval(this.clockInterval),this.updateClock(),this.clockInterval=setInterval(()=>{this.updateClock()},1e3)}updateClock(){const e=new Date;this.updateDigitalTime(e),this.updateAnalogClock(e)}updateDigitalTime(e){const t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),o=e.getSeconds().toString().padStart(2,"0");document.getElementById("hours").textContent=t,document.getElementById("minutes").textContent=n,document.getElementById("seconds").textContent=o;document.getElementById("dayName").textContent=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()],document.getElementById("date").textContent=e.getDate(),document.getElementById("month").textContent=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],document.getElementById("year").textContent=e.getFullYear()}updateAnalogClock(e){const t=e.getHours()%12,n=e.getMinutes(),o=30*t+.5*n,i=6*n,s=6*e.getSeconds(),a=document.getElementById("hourHand"),r=document.getElementById("minuteHand"),l=document.getElementById("secondHand");a&&(a.style.transform=`rotate(${o}deg)`),r&&(r.style.transform=`rotate(${i}deg)`),l&&(l.style.transform=`rotate(${s}deg)`)}adjustClockSize(){const e=document.querySelector(".clock-frame");if(!e)return;const t=document.querySelector(".timepiece-container").offsetWidth;let n=Math.min(400,.8*t);window.innerWidth<=768&&(n=Math.min(300,.9*t)),window.innerWidth<=480&&(n=Math.min(250,.95*t)),e.style.width=`${n}px`,e.style.height=`${n}px`}}function toggleClockStyle(){const e=window.luxuryTimepiece,t=document.querySelector(".clock-face");if(!e||!t)return;const n=["elegant","modern","classic"],o=(n.indexOf(e.clockStyle)+1)%n.length;switch(e.clockStyle=n[o],e.clockStyle){case"elegant":t.style.background="radial-gradient(circle, rgba(0, 0, 0, 0.8) 0%, rgba(20, 20, 20, 0.9) 100%)",t.style.border="2px solid var(--rose-gold-primary)",t.style.boxShadow="inset 0 0 30px var(--rose-gold-glow)";break;case"modern":t.style.background="radial-gradient(circle, rgba(30, 30, 30, 0.9) 0%, rgba(10, 10, 10, 0.95) 100%)",t.style.border="2px solid rgba(255, 255, 255, 0.3)",t.style.boxShadow="inset 0 0 30px rgba(255, 255, 255, 0.1)";break;case"classic":t.style.background="radial-gradient(circle, rgba(139, 69, 19, 0.3) 0%, rgba(20, 20, 20, 0.9) 100%)",t.style.border="2px solid rgba(205, 133, 63, 0.5)",t.style.boxShadow="inset 0 0 30px rgba(205, 133, 63, 0.2)"}showNotification(`Style: ${e.clockStyle.charAt(0).toUpperCase()+e.clockStyle.slice(1)}`)}function showWorldTime(){document.getElementById("worldTimeModal").classList.remove("hidden"),updateWorldClocks();const e=setInterval(updateWorldClocks,1e3);window.luxuryTimepiece.worldClockIntervals.push(e)}function closeWorldTime(){document.getElementById("worldTimeModal").classList.add("hidden"),window.luxuryTimepiece.worldClockIntervals.forEach(e=>clearInterval(e)),window.luxuryTimepiece.worldClockIntervals=[]}function updateWorldClocks(){Object.entries({nyTime:"America/New_York",londonTime:"Europe/London",tokyoTime:"Asia/Tokyo",dubaiTime:"Asia/Dubai"}).forEach(([e,t])=>{const n=document.getElementById(e);if(n)try{const e=(new Date).toLocaleTimeString("de-DE",{timeZone:t,hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});n.textContent=e}catch(e){n.textContent="--:--:--"}})}function showNotification(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: linear-gradient(45deg, rgba(232, 180, 184, 0.9), rgba(247, 202, 201, 0.9));\n        color: #000;\n        padding: 1rem 2rem;\n        border-radius: 25px;\n        box-shadow: 0 10px 30px rgba(232, 180, 184, 0.3);\n        z-index: 10000;\n        font-weight: 600;\n        letter-spacing: 1px;\n        animation: slideInTop 0.3s ease;\n        border: 1px solid var(--rose-gold-primary);\n    ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.animation="slideOutTop 0.3s ease",setTimeout(()=>{t.remove()},300)},2e3)}const style=document.createElement("style");style.textContent="\n    @keyframes slideInTop {\n        from {\n            opacity: 0;\n            transform: translateX(-50%) translateY(-50px);\n        }\n        to {\n            opacity: 1;\n            transform: translateX(-50%) translateY(0);\n        }\n    }\n    \n    @keyframes slideOutTop {\n        from {\n            opacity: 1;\n            transform: translateX(-50%) translateY(0);\n        }\n        to {\n            opacity: 0;\n            transform: translateX(-50%) translateY(-50px);\n        }\n    }\n    \n    @keyframes slideInRight {\n        from {\n            opacity: 0;\n            transform: translateX(300px);\n        }\n        to {\n            opacity: 1;\n            transform: translateX(0);\n        }\n    }\n",document.head.appendChild(style),document.addEventListener("DOMContentLoaded",()=>{window.luxuryTimepiece=new LuxuryTimepiece}),window.addEventListener("resize",()=>{window.luxuryTimepiece&&window.luxuryTimepiece.adjustClockSize()}),document.addEventListener("click",e=>{e.target.classList.contains("modal")&&closeWorldTime()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&closeWorldTime()}),document.addEventListener("mousemove",e=>{const t=document.querySelector(".clock-frame");if(!t)return;const n=t.getBoundingClientRect(),o=n.left+n.width/2,i=n.top+n.height/2,s=(e.clientX-o)/(n.width/2),a=(e.clientY-i)/(n.height/2),r=2*-a,l=2*s;Math.abs(s)<1&&Math.abs(a)<1?t.style.transform=`perspective(1000px) rotateX(${r}deg) rotateY(${l}deg)`:t.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg)"}),document.addEventListener("mouseleave",()=>{const e=document.querySelector(".clock-frame");e&&(e.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg)")}),window.addEventListener("load",function(){var e=/iP(ad|hone|od)/.test(navigator.userAgent)&&/WebKit/.test(navigator.userAgent)&&!/(CriOS|FxiOS|OPiOS|mercury)/.test(navigator.userAgent);"undefined"!=typeof particlesJS?particlesJS("particles-js",{particles:{number:{value:e?40:120,density:{enable:!0,value_area:800}},color:{value:"#E8B4A0"},shape:{type:"circle"},opacity:{value:.6,random:!0,anim:{enable:!0,speed:1,opacity_min:.3,sync:!1}},size:{value:4,random:!0,anim:{enable:!0,speed:2,size_min:.5,sync:!1}},line_linked:{enable:!0,distance:150,color:"#D4A574",opacity:e?.25:.4,width:e?1:1.5},move:{enable:!0,speed:e?1:2,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"window",events:{onhover:{enable:!0,mode:"repulse"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{repulse:{distance:e?80:150,duration:.4},push:{particles_nb:4}}},retina_detect:!0}):console.error("âŒ Particles.js library not loaded")}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("hamburgerBtn"),t=document.getElementById("mobileMenu"),n=document.getElementById("mobileLangBtn"),o=document.getElementById("mobileContactBtn"),i=document.getElementById("contactPopup");e&&t&&(e.addEventListener("click",n=>{n.preventDefault(),e.classList.toggle("active"),t.classList.toggle("active"),t.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow=""}),t.addEventListener("click",n=>{n.target===t&&(e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="")}),n&&n.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="",setTimeout(()=>{const e=document.getElementById("langBtn");if(e){e.click();const t=document.getElementById("langDropdownSimple");t&&(t.style.pointerEvents="none",setTimeout(()=>{t.style.pointerEvents="auto"},400))}},350)}),o&&o.addEventListener("click",n=>{n.preventDefault(),e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="",i&&i.classList.add("active")}))});